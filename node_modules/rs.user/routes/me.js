var express = require('express');
var router = express.Router();

module.exports = function (context) {
    var not_imp = function (req, res, next) {
        var err = new Error('Not Implemented');
        err.status = 404;
        next(err);
    };

    var params;
    var user = context.service.user;

    router.all('*', function (req, res, next) {
        params = {};
        params.success = function (results) {
            res.send(results);
        };
        params.failure = function (error) {
            res.json(error);
        };
        params.data = req.body;
        next();
    });

    router.get('/', function (req, res) {
        params.data = { user_uuid: context.current_user.user_uuid};
        user.get(params)
    });

    router.post('/', function (req, res) {
        params.data.user_uuid = context.current_user.user_uuid;
        user.updateProfile(params)
    });

    router.post('/', not_imp);
    return router;
};