const api_path = '/rs/user/1';
var rs = require('./misc/rs');

var user = rs.classy.define({
    init: function (ctx) {
        ctx = ctx || {};

        this.service = require('./services')({
            conn: ctx.conn
        });

        this.routes = require('./routes')({
            service: this.service,
            app: ctx.app
        });

        for (var rte in this.routes)
        {
            if(ctx.api_routes)
                ctx.api_routes.push(api_path + this.routes[rte].route);
            ctx.app.use(api_path + this.routes[rte].route, this.routes[rte].handler)
        }
    }
});
user.util = {token : require('./util/token')};

module.exports = user;