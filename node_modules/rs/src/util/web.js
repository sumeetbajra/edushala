var classy = require('classy');
var rs = require('./core');

/**
 * @classdesc Helper class to manipulate arrays.
 * @constructor
 */
var web = classy.define(/** @lends rs.util.web# */{
    forceInstance: true,
    res: function (c) {
        return this.response(c)
    },
    response : function (c) {
        if (c.is_error) {
            return c;
        }
        if(c.success)
            return c;
        if (c.null_results) {
            return { success: true, type: 'null', data: null }
        }

        var r = { success: true };
        var data = c.data;
        if (!data)
            data = c;

        if (!c.type)
            r.type = Array.isArray(data) ? 'array' : typeof (data);
        else
            r.type = c.type;



        if (!c.count)
            r.count = Array.isArray(data) ? data.length : (Object.keys(data).length === 0?0:1);
        else
            r.count = c.count;
        r.data = data;
        return r;
    }
});

module.exports = web;