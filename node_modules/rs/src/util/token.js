var classy = require('classy');
var rs = require('./core');
var jwt = require('jsonwebtoken');

/**
 * @classdesc Token Manager.
 * @constructor
 */
var token = classy.define(/** @lends rs.util.token# */{
    forceInstance: true,
    token: null,
    init: function (c) {
        rs.apply(this, c);
    },
    create : function (data, cfg) {
        cfg = cfg || {};
        //default expiry is 1 hour
        cfg.expire = cfg.expire || this.expire || Math.floor(Date.now() / 1000) + (60 * 60);
        return jwt.sign({
            exp: cfg.expire,
            data: data
        }, this.secret);
    },

    verify: function (token) {
        return jwt.verify(token, this.secret)
    }


});

module.exports = token;