var rs = require('../misc/rs');
var _base = require('./_base');
var nodemailer = require('nodemailer');
/**
 * @classdesc
 * @constructor
 */
var service = rs.classy.define(/** @lends rs.raven.services# */{
    extend: _base,
    init: function (c) {
        rs.apply(this, c);
        this.transporter = nodemailer.createTransport(c.config);
        this.callSuper()
    },
    send: function (msg, options) {
        if(msg.is_text)
            msg.text = msg.body;
        else
            msg.html = msg.body;

        this.transporter.sendMail(msg, function(error, content){
            if(error){
                if(options.fail)
                    return options.fail(error);
            }
            if(options.success)
                options.success(content);
        });
    }
});

module.exports = service;